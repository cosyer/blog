---
title: cron定时任务表达式
tags:
  - cron
copyright: true
comments: true
date: 2021-12-22 15:25:48
categories: 知识
top: 108
photos:
---

> 我们经常使用 cron 表达式来定义定时任务的执行策略，今天我们就总结一下 cron 表达式的一些相关知识。

## 表达式的定义

cron 表达式是一个字符串，该字符串由 6 个空格分为 7 个域，每一个域代表一个时间含义。 格式如下：

```js
[秒] [分] [时] [日] [月] [周] [年]

// 可能有5/6/7个域
Seconds Minutes Hours Day Month Week Year
Seconds Minutes Hours Day Month Week
Minutes Hours Day Month Week
```

`通常定义 “年” 的部分可以省略，实际常用的由 前六部分组成`

| 域  | 是否必填 | 值以及范围      | 通配符    |
| :-- | :------- | :-------------- | :-------- |
| 秒  | 是       | 0-59            | ,-\*/     |
| 分  | 是       | 0-59            | ,-\*/     |
| 时  | 是       | 0-23            | ,-\*/     |
| 日  | 是       | 1-31            | ,-\*?/L W |
| 月  | 是       | 1-12 或 JAN-DEC | ,-\*/     |
| 周  | 是       | 1-7 或 SUN-SAT  | ,-\*?/L # |
| 年  | 否       | 1970-2099       | ,-\*/     |

### \*

\*：表示匹配该域的任意值，假如在 Minutes 域使用\*，即表示每分钟都会触发事件。

### ?

?：只能用在 Day 和 Week 两个域。它表示不指定值，因为 Day 和 Week 互斥，当两个子表达式其中之一被指定了值以后，为了避免冲突，需要将另一个子表达式的值设"?"。

> 例如：想在每月的 20 日触发调度，不管 20 日到底是星期几，则只能使用如下写法： 13 13 15 20 _ ?，其中最后一位只能用？，而不能使用_，如果使用\*表示不管星期几都会触发，实际上并不是这样。

### -

-：表示范围，例如在 Minutes 域使用 5-20，表示从 5 分到 20 分钟每分钟触发一次

### /

/：表示起始时间开始触发，然后每隔固定时间触发一次（指定数值的增量），例如在 Minutes 域使用 5/20，则意味着 5 分钟触发一次，而 25，45 等分别触发一次.

### ,

,：表示列出枚举值。例如：在 Minutes 域使用 5,20，则意味着在 5 和 20 分每分钟触发一次。

### L

L：表示最后，它是单词`last`的缩写，只能出现在 Week 和 Day 域，在 Day 子表达式中，`L`表示一个月的最后一天，在 Week 子表达式中，`L`表示一个星期的最后一天，也就是 SAT（星期六）；如果在`L`前有具体的内容，它就具有其他的含义了，例如：`6L`表示这个月的倒数第６天。在`周`上表示周六，相当于`7`或`SAT`。如果在”L”前加上数字，则表示该数据的最后一个。例如在“周”上设置”7L”这样的格式,则表示“本月最后一个周六”

> 注意：在使用`L`参数时，不要指定列表或范围，因为这会导致问题

### W

W：表示有效工作日(周一到周五),只能出现在 Day 域，系统将在离指定日期的最近的有效工作日触发事件。

### LW

LW：这两个字符可以连用，表示在某个月最后一个工作日，即最后一个星期五。

> 例如：在 Day 使用 5W，如果 5 日是星期六，则将在最近的工作日：星期五，即 4 日触发。如果 5 日是星期天，则在 6 日触发； 如果 5 日在星期一到星期五中的一天，则就在 5 日触发。另外一点，W 的最近寻找不会跨过月份

###

#：用于确定每个月第几个星期几，只能出现在 Week 域。例如在 2#3，表示某月的第二个星期三。

## 示例

- 0 0 2 1 _ ? _：表示在每月的 1 日的凌晨 2 点调度任务

- 0 15 10 ? \*： MON-FRI 表示周一到周五每天上午 10：15 执行作业

- 0 15 10 ? 6L 2002-2006：表示 200-2006 年的每个月的最后一个星期五上午 10:15 执行作业

- 0 0 10,14,16 \* \* ?：每天上午 10 点，下午 2 点，4 点

- 0 0/30 9-17 \* \* ? ：朝九晚五工作时间内每半小时

- 0 0 12 ? \* WED：表示每个星期三中午 12 点

- 0 0 12 \* \* ? ：每天中午 12 点触发

- 0 15 10 ? \* \*：每天上午 10:15 触发

- 0 15 10 \* \* ?： 每天上午 10:15 触发

- 0 15 10 \* _ ? _： 每天上午 10:15 触发

- 0 15 10 \* \* ? 2005：2005 年的每天上午 10:15 触发

- 0 _ 14 _ \* ?：在每天下午 2 点到下午 2:59 期间的每 1 分钟触发

- 0 0/5 14 \* \* ?：在每天下午 2 点到下午 2:55 期间的每 5 分钟触发

- 0 0/5 14,18 \* \* ?：在每天下午 2 点到 2:55 期间和下午 6 点到 6:55 期间的每 5 分钟触发

- 0 0-5 14 \* \* ?：在每天下午 2 点到下午 2:05 期间的每 1 分钟触发

- 0 10,44 14 ? 3 WED：每年三月的星期三的下午 2:10 和 2:44 触发

- 0 15 10 ? \* MON-FRI： 周一至周五的上午 10:15 触发

- 0 15 10 15 \* ?：每月 15 日上午 10:15 触发

- 0 15 10 L \* ?：每月最后一日的上午 10:15 触发

- 0 15 10 ? \* 6L：每月的最后一个星期五上午 10:15 触发

- 0 15 10 ? \* 6L 2002-2005：2002 年至 2005 年的每月的最后一个星期五上午 10:15 触发

- 0 15 10 ? \* 6#3：每月的第三个星期五上午 10:15 触发

## 相关链接

[https://www.bejson.com/othertools/cron/](Cron表达式生成器)
[https://www.pppet.net/](cron在线生成器)
